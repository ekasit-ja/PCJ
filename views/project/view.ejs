<div class="container">
    <h2 class="header"><%=__("projects")%></h2>
    <form method="get" action="<%=sails.getUrlFor('ProjectController.view')%>">
        <div class="filter-project">
            Filter By:
            <span class="filter-label">Country</span>
            <select name="country" class="form-control">
                <option value="">All</option>
                <%_.each(countrySet, function(c) {%>
                    <option value="<%=c%>" <%=country==c?"selected":""%>><%=c%></option>
                <%})%>
            </select>

            <span class="filter-label">Year</span>
            <select name="year" class="form-control">
                <option value="">All</option>
                <%for(var i=yearSet.length-1; i>=0; i--) {%>
                    <option value="<%=yearSet[i]%>" <%=year==yearSet[i]?"selected":""%>><%=yearSet[i]%></option>
                <%}%>
            </select>
            <input type="submit" value="Go" class="btn btn-default btn-block">
        </div>
    </form>
    <hr>

    <%- partial("../base/btn-project.ejs") %>

</div>

<script type="text/javascript">
    var _this = $("form");
    _this.submit(function(e) {
        e.preventDefault();

        var country = _this.find("select[name=country]").val();
        var year = _this.find("select[name=year]").val();
        var url = _this.attr("action");

        if(country || year)
            url += "?country=" + country + "&year=" + year;

        window.location.href = url;
    });
</script>
